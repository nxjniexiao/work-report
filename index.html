<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Work Report</title>
  <link rel="stylesheet" href="css/reveal.css">
  <link rel="stylesheet" href="css/theme/sky.css">
  <!-- Theme used for syntax highlighting of code -->
  <link rel="stylesheet" href="lib/css/zenburn.css">
  <!-- 引入 bootstrap 样式文件 -->
  <link rel="stylesheet" href="src/lib/bootstrap.css">
  <!-- 自定义样式 -->
  <link rel="stylesheet" href="src/css/app.css">
  <link rel="stylesheet" href="src/cases/case-dropdown/infinite-dropdown.css">
  <link rel="stylesheet" href="src/cases/case-pagination/tm.pagination.css">
  <!-- Printing and PDF exports -->
  <script>
  var link = document.createElement('link');
  link.rel = 'stylesheet';
  link.type = 'text/css';
  link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
  document.getElementsByTagName('head')[0].appendChild(link);
  </script>
</head>
<body ng-app="myApp" ng-controller="myController">
<div class="reveal">
  <div class="slides">
    <section>
      <h2>述职报告</h2>
      <div class="fragment fade-up">
        <div>软件研发部</div>
        <div>聂骁骏</div>
      </div>
    </section>
    <section>
      <h3>我心中的尚阳</h3>
      <ul class="fragment fade-up">
        <li>待人友善</li>
        <li>工作积极</li>
        <li>气氛活跃</li>
      </ul>
    </section>
    <section>
      <section>
        <h3>工作汇总</h3>
        <ul>
          <li>金茂 H5: Vue + VueX</li>
          <li>金茂/东方锅炉 Web: AngularJS</li>
        </ul>
      </section>
      <section>
        <h4>金茂 H5</h4>
        <img src="src/images/H5-1.png" style="width: 300px" alt="">
        <img src="src/images/H5-2.png" style="width: 300px" alt="">
      </section>
      <section>
        <h4>金茂/东方锅炉 WEB</h4>
        <img src="src/images/web.png" style="width: 900px" alt="">
      </section>
    </section>
    <section>
      <section>
        <h3>工作收获</h3>
        <ol class="fragment fade-up">
          <li>对angularJS中指令的理解</li>
          <li>合理的组件设计</li>
          <li>代码重构</li>
          <li>页面性能优化</li>
        </ol>
      </section>
    </section>
    <section>
      <section>
        <h3>I. 对指令的理解</h3>
        <p>与 Vue 和 React 不同，AngularJS 在 1.5 版本之前是没有组件方法的。</p>
        <p>AngularJS 中组件是一种特殊的指令。</p>
        <p class="fragment fade-up">指令有四种类型：</p>
        <ul class="fragment fade-up text-align-left">
          <li><span class="color-red">元素名称(E)</span>: &lt;my-dir&gt;&lt;/my-dir&gt;</li>
          <li><span class="color-red">属性(A)</span>: &lt;span my-dir="exp"&gt;&lt;/span&gt;</li>
          <li>类名(C): &lt;span class="my-dir: exp;"&gt;</span></li>
          <li>注释(M): &lt;!-- directive: my-dir exp --&gt;</li>
        </ul>
      </section>
      <section class="dropdown-demo">
        <h4>下拉菜单 DEMO</h4>
        <p>原方案：引入整个 UI 库 <span class="color-red">layui</span> ，使用其中的下拉菜单组件</p>
        <p>
          新方案：使用<span class="color-red"> bootstrap </span> 提供的样式，创建两个<span class="color-red"> angularJS </span>组件：
        </p>
        <div class="fragment fade-up text-align-left">
          <p>infinite-dropdown: 包含按钮和第一级菜单，利用事件冒泡，监听点击事件</p>
          <p>infinite-submenu: 二级及以下菜单，如果某一个菜单有子菜单，则递归调用</p>
        </div>
        <div class="fragment fade-up" style="position:fixed;left:0;top:0">
          <infinite-dropdown selected-item="selectedCompany" list-array="companiesArray"></infinite-dropdown>
        </div>
      </section>
      <section
        data-markdown="src/markdown/infinite-dropdown.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
        <!--
            Note that Windows uses `\r\n` instead of `\n` as its linefeed character.
            For a regex that supports all operating systems, use `\r?\n` instead of `\n`.
        -->
      </section>
      <section
        data-markdown="src/markdown/infinite-submenu.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
    </section>
    <section>
      <section>
        <h3>II.合理的组件设计</h3>
        <div class="fragment fade-up text-align-left">《JS设计模式与开发实践》中:</div>
        <div class="fragment fade-up margin-top-30">
          <div class="text-align-left"><span class="color-red">开放-封闭原则</span>的思想：</div>
          <div class="text-align-left">
            当需要改变一个程序的功能或者给这个程序增加新功能的时候，
            可以使用增加代码的方式，但是<span class="color-red">不允许改动程序的源代码</span>。
          </div>
        </div>
        <div class="fragment fade-up margin-top-30">
          <div class="text-align-left">
            让程序尽量遵守<span class="color-red">开放-封闭原则</span>的规律，是找出程序中将要发生变化的地方，
            然后把<span class="color-red">变化</span>封装起来。
          </div>
        </div>
      </section>
      <section>
        <div class="text-align-left">
          <span class="color-red">合理的组件设计:</span>
          找出组件中将要发生变化的地方，然后把<span class="color-red">变化</span>封装起来。
        </div>
        <div class="fragment fade-up margin-top-30">
          <div class="text-align-left color-red">如何封装变化:</div>
          <ul>
            <li>向组件中传值(基本数据和对象，如开源库的配置文件)</li>
            <li>放置挂钩(layDate 中的ready/change/done 挂钩)</li>
            <li>向组件中传入回调函数(特殊的挂钩)</li>
          </ul>
        </div>
      </section>
      <section class="pagination-demo">
        <h3>DEMO 1 - 分页组件</h3>
        <div class="fragment fade-up">
          <ul>
            <li ng-repeat="item in partialListArray">{{item}}</li>
          </ul>
          <tm-pagination config="paginationConfig" callback="filterListArray()"></tm-pagination>
        </div>
      </section>
      <section
        data-markdown="src/markdown/pagination-watch-origin.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section>
        <div class="text-align-left">不足之处：职责有点混乱，页面与组件之间存在一定的耦合性。</div>
        <div class="fragment fade-up">
          <p>将<span class="color-red">不变的</span>和<span class="color-red">变化的</span>分隔开来:</p>
          <ul>
            <li>不变的：监听当前页的变化，此职责应该属于组件</li>
            <li>变化的：监听到变化后做的事情，此职责应该属于页面</li>
          </ul>
        </div>
        <div class="fragment fade-up text-align-left margin-top-30">更加合理的设计：组件内部监听变化后，执行页面委托给组件的函数。</div>
      </section>
      <section
        data-markdown="src/markdown/pagination-watch-opt.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section data-state="demo2-state-in">
        <h3>DEMO 2 - 时间选择组件</h3>
        <div class="fragment fade-up">
          <div class="text-align-left color-red">变化的:</div>
          <ul>
            <li>time: date对象，时间</li>
            <li><span class="color-grey">minTime / maxTime</span>: date对象，最小/最大时间</li>
            <li><span class="color-grey">mode</span>: 字符串，为'date'时仅显示日期弹窗</li>
            <li><span class="color-grey">isSameDay</span>: 布尔值，为true时日期弹窗不可用</li>
            <li><span class="color-grey">minutesGradient</span>: 数值，分钟梯度，用于向后取整</li>
            <li><span class="color-grey">increasedMinutes</span>: 数值，默认时间增加的分钟数</li>
          </ul>
        </div>
        <div class="fragment fade-up">
          <div class="text-align-left color-red">不变的:</div>
          <ul>
            <li>初始化 layDate 插件</li>
            <li>插件中选择日期和时间后，更新 model 中的值</li>
            <li>最大/最小值的限制等等</li>
          </ul>
        </div>
      </section>
      <section
        data-markdown="src/markdown/date-time-picker.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200"
        data-state="demo2-state-out">
        <!--
            Note that Windows uses `\r\n` instead of `\n` as its linefeed character.
            For a regex that supports all operating systems, use `\r?\n` instead of `\n`.
        -->
      </section>
    </section>
    <section>
      <section>
        <h3>III. 代码重构</h3>
        <div class="text-align-left">《JS设计模式与开发实践》中:</div>
        <div class="text-align-left">
          模式和重构之间有着一种与生俱来的关系。
          从某种角度来看，<span class="color-red">设计模式</span>的目的就是为许多<span class="color-red">重构</span>行为提供目标。
        </div>
        <div class="fragment fade-up text-align-left margin-top-30">
          重构手段：
          <div>1. 优化 if/else 语句</div>
          <div>2. 提炼过长的函数</div>
        </div>
      </section>
      <section>
        <h4>1. 优化 if/else 语句</h4>
        <div class="text-align-left">
          如果一个函数体内有一些条件分支语句，而这些条件分支语句内部散布了一些<span class="color-red">重复代码</span>，
          那么就有必要进行<span class="color-red">合并去重</span>工作。
        </div>
      </section>
      <section
        data-markdown="src/markdown/optimize-if-else-before.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section
        data-markdown="src/markdown/optimize-if-else-after.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section>
        <h4>2. 提炼过长的函数</h4>
        <div class="text-align-left">
          <p>在 JS 开发中，我们大部分时间都在与<span class="color-red">函数</span>打交道。</p>
          <p>如果一个函数过长，不得不加上若干注释才能让这个函数显得易读一些，那这些函数就很有必要进行<span class="color-red">重构</span>。</p>
        </div>
      </section>
      <section>
        <h4>提炼函数的好处</h4>
        <ul>
          <li>小函数比大函数更易于阅读</li>
          <li>独立出来的函数有助于代码复用</li>
          <li>独立出来的函数更容易被覆写</li>
          <li>良好的函数命名本身就起到了注释的作用</li>
        </ul>
      </section>
      <section
        data-markdown="src/markdown/large-fn.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section
        data-markdown="src/markdown/large-fn-1-structure.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section data-background-image="src/images/large-fn-add-update.png">
        <div class="color-white">新建 / 修改 混合会议的区别</div>
      </section>
      <section data-background-image="src/images/large-fn-mixed-or-not.png">
        <div class="color-white">新建立即 混合会议 / 视频会议 的区别</div>
      </section>
      <section
        data-markdown="src/markdown/large-fn-2-structure-optimized.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section>
        <h4>使用职责链模式</h4>
        <p>使多个对象都有机会处理请求，从而避免请求的<span class="color-red">发送者</span>和<span class="color-red">接收者</span>之间的耦合关系。</p>
        <p class="fragment fade-up">
          我们可以把如下四个对象连成<span class="color-red">一条链</span>，
          并沿着该链条传递处理会议的请求，直到有一个对象能处理它为止：
        </p>
        <ul class="fragment fade-up">
          <li>processForeverMeeting() 处理永久会议</li>
          <li>processForeverOrNowMeeting() 处理立即会议</li>
          <li>processMixedMeeting() 处理混合会议</li>
          <li>processNormalMeeting() 处理正常会议</li>
        </ul>
      </section>
      <section
        data-markdown="src/markdown/large-fn-3-after.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section
        data-markdown="src/markdown/large-fn-4-nodes.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section
        data-markdown="src/markdown/large-fn-5-chain.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>

    </section>
    <section>
      <section>
        <h3>IV. 页面性能优化 </h3>
        <p>进入会议室预约页面时，等待时间过长</p>
        <p>使用谷歌浏览器开发工具中的 <span class="color-red">Performance</span> 对页面进行优化</p>
      </section>
      <section data-background-image="src/images/enter-meeting-room-origin.png">
        <h4 class="right-down-corner">原始版本</h4>
      </section>
      <section data-background-image="src/images/enter-meeting-room-opt1.png">
        <div class="right-down-corner">
          <h4>优化1</h4>
          <p>删除 index.html 中引入 angular-touch.js 的 script 标签</p>
        </div>
      </section>
      <section class="w-1200">
        <h3>页面加载时间对比</h3>
        <table>
          <tr>
            <th>Item</th>
            <th>Timer Fired</th>
            <th>XHR Load(1)</th>
            <th>Recalculate Style</th>
            <th>XHR Load(2)</th>
            <th class="min-w-160 color-red">Total</th>
          </tr>
          <tr>
            <td>Origin</td>
            <td>2.39 s</td>
            <td>1.89 s</td>
            <td>0.24 s</td>
            <td>0.90 s</td>
            <td class="color-red">5.42 s</td>
          </tr>
          <tr>
            <td>opt1</td>
            <td>1.37 s</td>
            <td>0.60 s</td>
            <td>0.25 s</td>
            <td>0.95 s</td>
            <td class="color-red">2.96 s</td>
          </tr>
        </table>
        <p class="color-grey">XHR load 1: /api/notice/query</p>
        <p class="color-grey">XHR load 2: /api/monitor/meetingRoomOccupy</p>
      </section>
      <section data-background-image="src/images/meeting-room-notice.png">
        <h4>优化通知窗口</h4>
        <p>鼠标移入通知区域，弹出通知窗口时，有一定的延迟</p>
      </section>
      <section data-background-image="src/images/notices-origin.png">
        <div class="right-down-corner">
          <p>原始通知窗口显示时的性能:</p>
          <div class="fragment fade-up">
            <p><span class="color-red">8602</span> 个单元发生了样式重计算</p>
            <p><span class="color-red">16022</span> 个节点中有 <span class="color-red">15763</span> 个发生了布局计算(大小及位置)</p>
          </div>
        </div>
      </section>
      <section
        data-markdown="src/markdown/notice-origin.markdown"
        data-separator="^\n\n\n"
        data-separator-vertical="^\n\n"
        data-separator-notes="^Note:"
        data-charset="utf-8"
        class="w-1200">
      </section>
      <section data-background-image="src/images/notices-opt.png">
        <div class="right-down-corner">
          <p>优化后通知窗口显示时的性能:</p>
          <div class="fragment fade-up">
            <p><span class="color-blue">136</span> 个单元发生了样式重计算</p>
            <p><span class="color-blue">2213</span> 个节点中有 <span class="color-blue">241</span> 个发生了布局计算(大小及位置)</p>
          </div>
        </div>
      </section>
      <section class="w-1200">
        <h3>通知窗口加载时间对比</h3>
        <table>
          <tr class="font-size-30">
            <th>Item</th>
            <th>Event mouseover</th>
            <th class="fragment highlight-red">Recalculate Style</th>
            <th class="fragment highlight-red min-w-160">layout</th>
            <th>Update LayerTree</th>
            <th class="min-w-160">paint</th>
            <th class="min-w-160 color-red">Total</th>
          </tr>
          <tr class="font-size-30">
            <td>Origin</td>
            <td>6 ms</td>
            <td>275 ms</td>
            <td>154 ms</td>
            <td>26 ms</td>
            <td>13 ms</td>
            <td class="color-red">474 ms</td>
          </tr>
          <tr class="font-size-30">
            <td>Opt</td>
            <td>2 ms</td>
            <td>5 ms</td>
            <td>3 ms</td>
            <td>13 ms</td>
            <td>3 ms</td>
            <td class="color-red">26 ms</td>
          </tr>
        </table>
        <div class="fragment fade-up">
          <p class="color-grey font-size-30">
            优化前: <span class="color-red">8602</span> 个单元发生了样式重计算，
            <span class="color-red">15763/16022</span> 个节点发生了布局重计算
          </p>
          <p class="color-grey font-size-30">
            优化后: <span class="color-blue margin-left-18">136</span> 个单元发生了样式重计算，
            <span class="color-blue margin-left-52">241/2213</span> 个节点发生了布局重计算
          </p>
        </div>
      </section>
      <section data-background-image="src/images/enter-meeting-room-opt2.png">
        <div class="right-down-corner">
          <p>优化通知窗口后，页面加载时间也得到了改善</p>
        </div>
      </section>
      <section class="w-1200">
        <h3>页面加载时间对比</h3>
        <table>
          <tr>
            <th>Item</th>
            <th class="min-w-190">Timer Fired</th>
            <th>XHR Load(1)</th>
            <th>Recalculate Style</th>
            <th>XHR Load(2)</th>
            <th class="min-w-160 color-red">Total</th>
          </tr>
          <tr>
            <td>Origin</td>
            <td>2.39 s</td>
            <td>1.89 s</td>
            <td>0.24 s</td>
            <td>0.90 s</td>
            <td class="color-red">5.42 s</td>
          </tr>
          <tr>
            <td>Opt1</td>
            <td>1.37 s</td>
            <td>0.60 s</td>
            <td>0.25 s</td>
            <td>0.95 s</td>
            <td class="color-red">2.96 s</td>
          </tr>
          <tr>
            <td>Opt2</td>
            <td>455 ms</td>
            <td>76 ms</td>
            <td>8 ms</td>
            <td>937 ms</td>
            <td class="color-red">1.48 s</td>
          </tr>
        </table>
      </section>
    </section>
    <section>
      <h3>目标</h3>
      <ol>
        <li class="fragment fade-up">成为一名合格的前端工程师：编写高性能、可复用和可维护性高的程序。</li>
        <li class="fragment fade-up">了解其他相关知识：数据结构、算法和 HTTP 等。</li>
        <li class="fragment fade-up">关注前沿技术：如 JavaScript 的超集 TypeScript，三大主流前端框架已支持。</li>
      </ol>
    </section>
    <section>
      <h2>谢谢!</h2>
    </section>
  </div>
</div>
<div class="" style="position:fixed;left:0;top:0;z-index:999;" ng-show="isDemo2Shown">
  <form class="form-horizontal">
    <div class="form-group form-group-10">
      <label class="control-label col-md-4 font-size-30">开会时间</label>
      <div class="col-md-7 margin-top-10">
        <date-time-selector time="startTime" minutes-gradient="5"></date-time-selector>
      </div>
    </div>
    <div class="form-group form-group-10">
      <label class="control-label col-md-4 font-size-30">结束时间</label>
      <div class="col-md-7 margin-top-10">
        <date-time-selector time="endTime" min-time="startTime" minutes-gradient="5" increased-minutes="60"
                            is-same-day="true"></date-time-selector>
      </div>
    </div>
    <div class="form-group form-group-10">
      <label class="control-label col-md-4 font-size-30">调试时间</label>
      <div class="col-md-7 margin-top-10">
        <date-time-selector time="debugTime" max-time="startTime" mode="date"></date-time-selector>
      </div>
    </div>
  </form>
</div>
<script src="lib/js/head.min.js"></script>
<script src="js/reveal.js"></script>

<script>
// More info about config & dependencies:
// - https://github.com/hakimel/reveal.js#configuration
// - https://github.com/hakimel/reveal.js#dependencies
Reveal.initialize({
  dependencies: [
    {src: 'plugin/markdown/marked.js'},
    {src: 'plugin/markdown/markdown.js'},
    {src: 'plugin/notes/notes.js', async: true},
    {
      src: 'plugin/highlight/highlight.js', async: true, callback: function () {
        hljs.initHighlightingOnLoad();
      }
    }
  ],
  slideNumber: true,// Display the page number of the current slide
  pdfSeparateFragments: false,// let all the fragment steps in a slide to be printed in one pdf page
});
</script>
<!-- 库 -->
<script src="./src/lib/jquery.js"></script>
<script src="./src/lib/bootstrap.js"></script>
<script src="./src/lib/angular.min.js"></script>
<script src="./src/lib/laydate/laydate.js"></script>
<!-- 自定义文件 -->
<script src="src/cases/my-app.js"></script>
<script src="./src/cases/case-dropdown/infinite-dropdown.directive.js"></script>
<script src="./src/cases/case-dropdown/infinite-submenu.directive.js"></script>
<script src="./src/cases/case-pagination/tm.pagination.js"></script>
<script src="./src/cases/case-date-time-picker/date-time-selector.js"></script>
</body>
</html>
